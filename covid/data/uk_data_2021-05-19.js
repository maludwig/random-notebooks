const fs = require('fs').promises;
const {Duration, DateTime} = require('luxon');
const data = {
    endDate: '2021-05-18',
    series: [
        {
            name: 'Total Cases',
            color: '#33CCFF',
            lineWidth: 5,
            data: [9, 9, 9, 9, 9, 9, 9, 9, 13, 13, 13, 13, 16, 20, 23, 35, 38, 49, 82, 108, 151, 192, 254, 293, 349, 419, 536, 725, 1034, 1262, 1399, 1767, 2379, 2961, 3607, 4543, 5145, 6020, 7311, 8625, 10550, 13159, 15462, 17662, 20031, 22752, 26662, 30500, 34525, 37903, 43241, 46679, 49966, 54931, 58859, 66705, 71437, 76219, 80145, 84894, 89056, 93231, 98295, 103292, 108582, 112810, 116699, 120725, 124869, 129739, 134182, 138219, 142115, 145728, 149414, 154869, 160477, 164823, 168747, 172350, 176335, 181861, 186938, 191142, 194665, 198212, 201718, 204795, 207728, 210844, 214063, 217183, 220378, 222829, 225010, 226379, 228744, 231717, 234393, 236568, 238037, 239849, 241669, 243376, 245271, 246721, 248472, 249891, 251385, 253077, 254710, 256202, 257609, 258808, 259898, 261473, 262380, 263525, 264918, 266207, 267576, 268451, 269607, 270615, 271716, 272934, 274105, 275209, 276075, 276907, 277497, 278508, 279757, 280562, 281377, 282113, 282736, 283486, 284063, 284583, 285208, 285725, 286077, 286659, 287290, 287933, 288445, 289265, 289915, 290444, 290841, 291378, 292018, 292704, 293529, 294254, 294833, 295277, 295836, 296604, 297371, 298137, 298881, 299565, 300145, 300907, 301751, 302629, 303399, 304141, 305067, 305736, 306625, 307573, 308442, 309199, 310259, 311074, 312220, 313227, 314354, 315791, 316866, 317904, 318616, 319703, 320514, 321694, 322725, 324011, 325169, 326020, 327202, 328248, 329767, 331041, 332147, 333859, 335262, 336555, 338060, 339792, 341728, 343538, 346521, 349464, 351919, 354573, 357487, 361020, 364511, 367835, 370449, 373548, 377532, 380921, 385235, 389743, 393891, 398320, 403390, 410276, 417620, 425124, 432689, 440388, 445041, 454140, 464278, 475305, 487037, 494094, 502060, 514631, 529146, 543282, 560790, 574628, 589766, 602614, 616558, 633760, 653446, 672376, 687997, 704137, 721087, 739856, 761147, 787782, 808986, 829478, 852448, 872202, 893054, 915896, 940552, 963575, 987935, 1009810, 1033021, 1051936, 1071917, 1097045, 1121141, 1144384, 1169294, 1189826, 1211135, 1231508, 1254414, 1287821, 1315070, 1341879, 1366792, 1388113, 1408124, 1427694, 1450566, 1470779, 1490616, 1509242, 1524662, 1535938, 1554116, 1570355, 1586345, 1602184, 1614314, 1626617, 1640019, 1656155, 1671002, 1687265, 1702770, 1720004, 1734688, 1746941, 1763483, 1784401, 1806024, 1827479, 1845884, 1866102, 1884510, 1909617, 1944908, 1973341, 2000322, 2036156, 2069432, 2106141, 2145276, 2184210, 2216850, 2253287, 2283708, 2324985, 2377982, 2427874, 2483618, 2536761, 2594334, 2649179, 2707808, 2768563, 2830721, 2883201, 2951074, 3010853, 3065648, 3111695, 3157107, 3204507, 3253061, 3308671, 3349908, 3388404, 3425840, 3459107, 3497910, 3535703, 3575858, 3609321, 3639246, 3661381, 3681417, 3706659, 3735286, 3764261, 3787452, 3808464, 3827004, 3843783, 3862916, 3883476, 3902521, 3920718, 3936506, 3950559, 3962878, 3975844, 3989289, 4004377, 4017638, 4028571, 4038301, 4048887, 4061560, 4073574, 4085558, 4095927, 4105726, 4116328, 4124786, 4134688, 4144637, 4153129, 4160536, 4166549, 4171984, 4178352, 4184714, 4191262, 4197187, 4203205, 4208364, 4213059, 4218804, 4224709, 4231387, 4237923, 4243396, 4247963, 4252996, 4258231, 4263925, 4270158, 4274906, 4280431, 4285684, 4290966, 4296005, 4301548, 4307698, 4313257, 4317919, 4321738, 4326340, 4330335, 4334342, 4338771, 4342136, 4345522, 4347794, 4350526, 4352878, 4355611, 4358606, 4361722, 4364287, 4366001, 4369535, 4371984, 4374451, 4377085, 4379802, 4381977, 4383832, 4386753, 4389241, 4391602, 4394292, 4396932, 4398964, 4400652, 4402687, 4405334, 4407469, 4409878, 4412224, 4414103, 4415749, 4417374, 4419291, 4421403, 4423977, 4426430, 4428447, 4430191, 4432513, 4434950, 4437198, 4439855, 4442048, 4444075, 4446001, 4447980, 4450392]
        },
        {
            name: 'Daily New Cases',
            color: '#999',
            lineWidth: 4,
            showCheckbox: false,
            data: [0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 3, 4, 3, 12, 3, 11, 33, 26, 43, 41, 62, 39, 56, 70, 117, 189, 309, 228, 137, 368, 612, 582, 646, 936, 602, 875, 1291, 1314, 1925, 2609, 2303, 2200, 2369, 2721, 3910, 3838, 4025, 3378, 5338, 3438, 3287, 4965, 3928, 7846, 4732, 4782, 3926, 4749, 4162, 4175, 5064, 4997, 5290, 4228, 3889, 4026, 4144, 4870, 4443, 4037, 3896, 3613, 3686, 5455, 5608, 4346, 3924, 3603, 3985, 5526, 5077, 4204, 3523, 3547, 3506, 3077, 2933, 3116, 3219, 3120, 3195, 2451, 2181, 1369, 2365, 2973, 2676, 2175, 1469, 1812, 1820, 1707, 1895, 1450, 1751, 1419, 1494, 1692, 1633, 1492, 1407, 1199, 1090, 1575, 907, 1145, 1393, 1289, 1369, 875, 1156, 1008, 1101, 1218, 1171, 1104, 866, 832, 590, 1011, 1249, 805, 815, 736, 623, 750, 577, 520, 625, 517, 352, 582, 631, 643, 512, 820, 650, 529, 397, 537, 640, 686, 825, 725, 579, 444, 559, 768, 767, 766, 744, 684, 580, 762, 844, 878, 770, 742, 926, 669, 889, 948, 869, 757, 1060, 815, 1146, 1007, 1127, 1437, 1075, 1038, 712, 1087, 811, 1180, 1031, 1286, 1158, 851, 1182, 1046, 1519, 1274, 1106, 1712, 1403, 1293, 1505, 1732, 1936, 1810, 2983, 2943, 2455, 2654, 2914, 3533, 3491, 3324, 2614, 3099, 3984, 3389, 4314, 4508, 4148, 4429, 5070, 6886, 7344, 7504, 7565, 7699, 4653, 9099, 10138, 11027, 11732, 7057, 7966, 12571, 14515, 14136, 17508, 13838, 15138, 12848, 13944, 17202, 19686, 18930, 15621, 16140, 16950, 18769, 21291, 26635, 21204, 20492, 22970, 19754, 20852, 22842, 24656, 23023, 24360, 21875, 23211, 18915, 19981, 25128, 24096, 23243, 24910, 20532, 21309, 20373, 22906, 33407, 27249, 26809, 24913, 21321, 20011, 19570, 22872, 20213, 19837, 18626, 15420, 11276, 18178, 16239, 15990, 15839, 12130, 12303, 13402, 16136, 14847, 16263, 15505, 17234, 14684, 12253, 16542, 20918, 21623, 21455, 18405, 20218, 18408, 25107, 35291, 28433, 26981, 35834, 33276, 36709, 39135, 38934, 32640, 36437, 30421, 41277, 52997, 49892, 55744, 53143, 57573, 54845, 58629, 60755, 62158, 52480, 67873, 59779, 54795, 46047, 45412, 47400, 48554, 55610, 41237, 38496, 37436, 33267, 38803, 37793, 40155, 33463, 29925, 22135, 20036, 25242, 28627, 28975, 23191, 21012, 18540, 16779, 19133, 20560, 19045, 18197, 15788, 14053, 12319, 12966, 13445, 15088, 13261, 10933, 9730, 10586, 12673, 12014, 11984, 10369, 9799, 10602, 8458, 9902, 9949, 8492, 7407, 6013, 5435, 6368, 6362, 6548, 5925, 6018, 5159, 4695, 5745, 5905, 6678, 6536, 5473, 4567, 5033, 5235, 5694, 6233, 4748, 5525, 5253, 5282, 5039, 5543, 6150, 5559, 4662, 3819, 4602, 3995, 4007, 4429, 3365, 3386, 2272, 2732, 2352, 2733, 2995, 3116, 2565, 1714, 3534, 2449, 2467, 2634, 2717, 2175, 1855, 2921, 2488, 2361, 2690, 2640, 2032, 1688, 2035, 2647, 2135, 2409, 2346, 1879, 1646, 1625, 1917, 2112, 2574, 2453, 2017, 1744, 2322, 2437, 2248, 2657, 2193, 2027, 1926, 1979, 2412]
        },
        {
            name: 'Currently Infected',
            color: '#00DDDD',
            lineWidth: 5,
            data: [1, 1, 1, 1, 1, 1, 1, 1, 5, 5, 5, 5, 8, 12, 15, 27, 30, 41, 74, 89, 132, 172, 234, 272, 324, 394, 509, 697, 988, 1200, 1283, 1623, 2202, 2742, 3356, 4210, 4788, 5554, 6702, 7838, 9537, 11863, 13872, 15858, 17852, 20190, 23438, 26635, 29925, 32542, 37235, 40105, 42353, 46284, 49104, 55590, 59482, 63579, 66760, 70466, 73787, 76932, 81060, 84947, 89742, 93413, 96134, 99336, 102761, 106628, 110239, 113871, 117447, 120157, 123075, 127872, 132770, 136528, 140161, 143486, 146794, 151708, 156292, 159906, 163140, 166446, 169758, 172271, 174760, 177499, 180390, 183082, 186177, 188478, 190186, 191246, 193327, 192396, 191519, 190510, 186819, 185341, 184118, 181117, 179299, 173329, 170555, 167330, 164848, 162096, 159863, 157295, 153806, 150365, 146208, 143509, 140833, 138172, 135564, 132178, 129293, 126480, 123722, 121128, 118886, 114904, 110652, 107517, 104511, 101738, 98486, 94108, 90332, 87138, 84544, 81766, 78873, 76629, 74387, 71819, 69317, 66793, 63966, 62069, 60572, 59917, 58101, 56005, 54040, 52416, 51309, 50094, 48975, 48026, 47022, 46323, 45169, 44187, 43283, 42446, 41585, 40889, 40250, 39749, 39227, 38430, 38420, 38165, 37560, 37023, 36585, 36367, 36130, 36076, 35853, 35414, 35305, 35008, 35282, 35460, 35995, 36417, 36270, 36512, 36413, 36754, 36946, 37403, 37856, 38621, 39160, 39494, 40308, 40773, 41662, 42301, 42894, 43786, 44541, 45318, 46429, 47630, 48933, 50055, 52212, 54431, 56277, 58490, 60846, 63610, 66326, 68896, 70762, 73153, 76552, 79173, 82626, 86236, 89607, 93283, 97390, 103572, 109995, 116527, 123197, 130133, 133713, 141928, 150879, 160846, 171397, 176971, 183836, 195353, 209088, 222092, 238731, 251321, 265372, 276894, 289646, 305863, 324265, 342046, 356049, 370798, 386607, 403598, 423255, 448475, 468053, 486645, 507567, 525406, 543201, 562746, 584708, 604862, 626106, 644203, 663836, 679350, 696364, 718037, 737900, 757530, 777840, 793850, 810876, 826359, 843831, 869966, 889670, 908722, 926062, 939608, 954460, 964751, 977274, 986209, 994225, 1005708, 1013103, 1011313, 1014649, 1016720, 1015026, 1016877, 1014041, 1013423, 1012445, 1011230, 1006535, 1003891, 1003724, 1005019, 1002718, 995764, 991040, 985286, 985741, 986656, 982246, 982840, 980057, 982274, 993027, 998402, 1000964, 1015036, 1025056, 1042328, 1061303, 1075136, 1083478, 1096891, 1102436, 1122970, 1154374, 1183488, 1215850, 1235425, 1265676, 1293725, 1327084, 1365877, 1407447, 1439766, 1506312, 1522908, 1577139, 1622656, 1666823, 1712657, 1759961, 1717602, 1742090, 1764284, 1789281, 1809008, 1832972, 1854285, 1879122, 1895550, 1909771, 1914495, 1918632, 1930694, 1958080, 1985808, 2007797, 2028221, 1952318, 1947912, 1948514, 1944561, 1928456, 1918597, 1908254, 1886717, 1865218, 1841988, 1817337, 1793920, 1775235, 1750726, 1730335, 1699328, 1659758, 1623019, 1579816, 1537700, 1490760, 1446781, 1396312, 1346304, 1294930, 1251373, 1191451, 1138211, 1088975, 1049164, 1055211, 970673, 928359, 879221, 884298, 809864, 778073, 751233, 719564, 688488, 657424, 625522, 600701, 583810, 569823, 551097, 527387, 504083, 486318, 462213, 391601, 336680, 287973, 249533, 209952, 194677, 189359, 183387, 178887, 175896, 173237, 171178, 167071, 163430, 159222, 156020, 152986, 150934, 130345, 125495, 123499, 121328, 118700, 116058, 113024, 106868, 100417, 98042, 95171, 92455, 89554, 85964, 82393, 66863, 64858, 63024, 61751, 60750, 52936, 51792, 50293, 49329, 49516, 48061, 48163, 42698, 42509, 42371, 41730, 41643, 41496, 41424, 40939, 40898, 41115, 41029, 40754]
        },
        {
            name: 'Total Deaths',
            color: '#FF9900',
            lineWidth: 5,
            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 7, 7, 9, 10, 28, 42, 64, 79, 112, 154, 186, 240, 264, 331, 474, 652, 878, 1161, 1455, 1669, 2044, 2427, 3089, 3730, 4465, 5226, 5871, 6439, 7478, 8512, 9620, 10771, 11611, 12296, 13041, 14084, 14925, 15955, 16891, 18001, 18496, 19053, 20221, 21045, 21764, 22767, 23599, 24004, 24324, 25227, 25995, 26653, 27363, 27951, 28242, 28520, 29197, 29809, 30302, 30892, 31181, 31422, 31616, 32180, 32624, 33001, 33329, 33757, 33857, 34007, 34480, 34789, 35073, 35381, 35611, 35998, 36101, 36225, 36651, 36996, 37266, 37415, 37488, 37582, 37819, 38068, 38207, 38460, 38611, 38672, 38719, 38907, 39066, 39148, 39281, 39385, 39418, 39448, 39562, 39668, 39743, 39822, 39897, 39931, 39945, 40034, 40121, 40223, 40301, 40341, 40372, 40393, 40444, 40543, 40583, 40631, 40666, 40685, 40696, 40749, 40806, 40838, 40872, 40889, 40898, 40906, 40952, 40978, 41001, 41028, 41037, 41048, 41058, 41083, 41100, 41109, 41141, 41156, 41164, 41167, 41188, 41222, 41224, 41242, 41255, 41260, 41261, 41279, 41293, 41311, 41323, 41326, 41331, 41348, 41362, 41382, 41400, 41411, 41414, 41419, 41422, 41434, 41450, 41456, 41458, 41476, 41482, 41486, 41502, 41518, 41530, 41539, 41551, 41552, 41554, 41557, 41567, 41580, 41590, 41602, 41604, 41607, 41639, 41647, 41661, 41667, 41676, 41681, 41690, 41717, 41737, 41758, 41785, 41812, 41830, 41841, 41878, 41915, 41955, 41990, 42024, 42041, 42054, 42125, 42196, 42255, 42321, 42370, 42403, 42422, 42498, 42568, 42645, 42732, 42813, 42878, 42928, 43071, 43208, 43346, 43482, 43632, 43699, 43779, 44020, 44211, 44400, 44624, 44798, 44949, 45051, 45419, 45729, 46009, 46283, 46609, 46771, 46907, 47305, 47798, 48177, 48533, 48947, 49103, 49297, 49830, 50426, 50990, 51367, 51830, 51998, 52211, 52810, 53340, 53842, 54353, 54694, 55093, 55299, 55907, 56604, 57102, 57624, 58104, 58317, 58522, 59126, 59775, 60190, 60695, 61093, 61324, 61496, 62113, 62647, 63164, 63590, 64110, 64254, 64486, 64993, 65606, 66139, 66629, 67164, 67490, 67705, 68397, 69142, 69717, 70288, 70529, 70845, 71247, 71662, 72644, 73609, 74223, 74669, 75124, 75576, 76407, 77450, 78614, 79941, 80978, 81542, 82072, 83317, 84883, 86133, 87415, 88712, 89384, 89984, 91596, 93419, 94711, 96114, 97464, 98075, 98668, 100301, 102029, 103270, 104517, 105719, 106307, 106714, 108165, 109489, 110405, 111420, 112249, 112623, 112956, 114010, 115012, 115691, 116450, 117072, 117330, 117560, 118360, 119099, 119554, 120088, 120534, 120748, 120926, 121475, 121918, 122241, 122587, 122877, 123021, 123125, 123468, 123783, 124025, 124261, 124419, 124501, 124566, 124797, 124987, 125168, 125343, 125464, 125516, 125580, 125690, 125831, 125925, 126026, 126122, 126155, 126172, 126284, 126382, 126445, 126515, 126573, 126592, 126614, 126670, 126713, 126764, 126816, 126826, 126836, 126862, 126882, 126927, 126980, 127040, 127080, 127087, 127100, 127123, 127161, 127191, 127225, 127260, 127270, 127274, 127305, 127327, 127345, 127385, 127417, 127428, 127434, 127451, 127480, 127502, 127517, 127524, 127538, 127539, 127543, 127570, 127583, 127598, 127603, 127605, 127609, 127629, 127640, 127651, 127668, 127675, 127679, 127684, 127691]
        },
        {
            name: 'Daily New Deaths',
            color: '#999',
            lineWidth: 4,
            showCheckbox: false,
            data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 4, 0, 2, 1, 18, 14, 22, 15, 33, 42, 32, 54, 24, 67, 143, 178, 226, 283, 294, 214, 375, 383, 662, 641, 735, 761, 645, 568, 1039, 1034, 1108, 1151, 840, 685, 745, 1043, 841, 1030, 936, 1110, 495, 557, 1168, 824, 719, 1003, 832, 405, 320, 903, 768, 658, 710, 588, 291, 278, 677, 612, 493, 590, 289, 241, 194, 564, 444, 377, 328, 428, 100, 150, 473, 309, 284, 308, 230, 387, 103, 124, 426, 345, 270, 149, 73, 94, 237, 249, 139, 253, 151, 61, 47, 188, 159, 82, 133, 104, 33, 30, 114, 106, 75, 79, 75, 34, 14, 89, 87, 102, 78, 40, 31, 21, 51, 99, 40, 48, 35, 19, 11, 53, 57, 32, 34, 17, 9, 8, 46, 26, 23, 27, 9, 11, 10, 25, 17, 9, 32, 15, 8, 3, 21, 34, 2, 18, 13, 5, 1, 18, 14, 18, 12, 3, 5, 17, 14, 20, 18, 11, 3, 5, 3, 12, 16, 6, 2, 18, 6, 4, 16, 16, 12, 9, 12, 1, 2, 3, 10, 13, 10, 12, 2, 3, 32, 8, 14, 6, 9, 5, 9, 27, 20, 21, 27, 27, 18, 11, 37, 37, 40, 35, 34, 17, 13, 71, 71, 59, 66, 49, 33, 19, 76, 70, 77, 87, 81, 65, 50, 143, 137, 138, 136, 150, 67, 80, 241, 191, 189, 224, 174, 151, 102, 368, 310, 280, 274, 326, 162, 136, 398, 493, 379, 356, 414, 156, 194, 533, 596, 564, 377, 463, 168, 213, 599, 530, 502, 511, 341, 399, 206, 608, 697, 498, 522, 480, 213, 205, 604, 649, 415, 505, 398, 231, 172, 617, 534, 517, 426, 520, 144, 232, 507, 613, 533, 490, 535, 326, 215, 692, 745, 575, 571, 241, 316, 402, 415, 982, 965, 614, 446, 455, 452, 831, 1043, 1164, 1327, 1037, 564, 530, 1245, 1566, 1250, 1282, 1297, 672, 600, 1612, 1823, 1292, 1403, 1350, 611, 593, 1633, 1728, 1241, 1247, 1202, 588, 407, 1451, 1324, 916, 1015, 829, 374, 333, 1054, 1002, 679, 759, 622, 258, 230, 800, 739, 455, 534, 446, 214, 178, 549, 443, 323, 346, 290, 144, 104, 343, 315, 242, 236, 158, 82, 65, 231, 190, 181, 175, 121, 52, 64, 110, 141, 94, 101, 96, 33, 17, 112, 98, 63, 70, 58, 19, 22, 56, 43, 51, 52, 10, 10, 26, 20, 45, 53, 60, 40, 7, 13, 23, 38, 30, 34, 35, 10, 4, 31, 22, 18, 40, 32, 11, 6, 17, 29, 22, 15, 7, 14, 1, 4, 27, 13, 15, 5, 2, 4, 20, 11, 11, 17, 7, 4, 5, 7]
        },


    ],
};

console.log(JSON.stringify(data));
for (const one_series of data.series) {
    console.log(`Note: ${one_series.name}`);
    console.log(`Count: ${one_series.data.length}`)
}

const ONE_DAY = Duration.fromISO('P1D');
async function makeJson() {
    const rows = [];
    let endDate = DateTime.fromISO(data.endDate);
    let code_name;
    for (let i = data.series[0].data.length - 1; i >= 0; i--) {
        const row = {date: endDate.toISODate()};
        for (const one_series of data.series) {
            code_name = one_series.name.toLowerCase().replace(/ /g, '_');
            row[code_name] = one_series.data[i];
        }
        rows.push(row);
        endDate = endDate.minus(ONE_DAY);
    }
    await fs.writeFile(`uk_data_${data.endDate}.json`, JSON.stringify(rows));
}

makeJson().catch(console.error);
